from src.experiments.config import run_config
from src.experiments.utils import get_run_name, get_save_path_and_experiment_name

# Config generated by src.experiments.config.py#generate_config
cur_config = {
    'model': {
        'name': 'end2end',
        'params': {
            'config_paths': ['C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\dLinkNet\\cil_cluster0\\dLinkNet_cil_cluster0_pretrained_all_cluster0_acc0-95_date27-07-2024_17-30-15_1.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\dLinkNet\\cil_cluster1\\dLinkNet_cil_cluster1_pretrained_all_cluster1_acc0-94_date27-07-2024_17-35-19_9.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\PSPNet\\cil_cluster0\\PSPNet_cil_cluster0_pretrained_all_cluster0_acc0-95_date27-07-2024_17-02-00_2.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\PSPNet\\cil_cluster1\\PSPNet_cil_cluster1_pretrained_all_cluster1_acc0-94_date27-07-2024_17-04-01_9.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\UNetPlusPlus\\cil_cluster0\\unetplusplus_cil_cluster0_pretrained_all_cluster0_acc0-95_date28-07-2024_11-05-53_9.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\UNetPlusPlus\\cil_cluster1\\unetplusplus_cil_cluster1_pretrained_all_cluster1_acc0-94_date28-07-2024_11-15-39_3.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\deepLab\\resnet\\cil_cluster0\\deeplabv3plus_cil_cluster0_pretrained_all_cluster0_resnet_acc0-95_date28-07-2024_14-19-54_7.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\deepLab\\resnet\\cil_cluster1\\deeplabv3plus_cil_cluster1_pretrained_all_cluster1_resnet_acc0-94_date28-07-2024_14-38-17_8.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\deepLab\\hrnet\\same_but_clusters\\cluster0_deeplabv3plus_cil_pretrained_all_both_clusters_acc0-95_date28-07-2024_13-39-10_1.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\deepLab\\hrnet\\same_but_clusters\\cluster1_deeplabv3plus_cil_pretrained_all_both_clusters_acc0-95_date28-07-2024_13-39-10_1.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\dinoPlusUNet\\same_but_cluster\\cluster0_dino_plus_unet_cil_pretrained_all_both_clusters_acc0-94_date29-07-2024_09-12-16_0.json',
                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\dinoPlusUNet\\same_but_cluster\\cluster0_dino_plus_unet_cil_pretrained_all_both_clusters_acc0-94_date29-07-2024_09-12-16_0.json',

                             'C:\\Users\\Louis\\Desktop\\CIL_results_files-NEW\\masked-deeplab\\cil\\end2end_cilmae.json'],

            'voter': 'hard_voting_pixel_level',
            'train_mae': True,
            'mode': 'voter-then-mae-debug',
            'resize_to': (400, 400),
        },
    },
    'dataset': {
        'name': 'cil',
        'params': {
            'batch_size': 4,
            'num_workers': 4,
            'shuffle': True,
            'resize_to': (400, 400),
            'augment': ["geometric"]
        }
    },
    'train': {
        'n_epochs': 1,
        'optimizer': {
            'name': 'Adam',
            'params': {
                'lr': 0.0005
            }
        },
        'loss': 'BCELoss',
        'clip_grad': None,
        'n_gpus': 0
    }
}


if __name__ == '__main__':
    save_path, experiment_name = get_save_path_and_experiment_name(__file__)
    run_name = get_run_name(cur_config)

    run_config(cur_config, save_path, experiment_name, run_name, log_wandb=True)
